<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>ALUBA VIP EVOLUTION</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: 'Arial Black', sans-serif; overflow: hidden; }
        canvas { display: block; }
        
        #ui { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        .card { background: rgba(0,0,0,0.9); border: 3px solid #ff0000; padding: 25px; border-radius: 20px; text-align: center; width: 320px; box-shadow: 0 0 30px #f00; }
        
        /* ПЕТУХ (Для телефонов) */
        #mobile-chicken { display: none; width: 90vw; border-radius: 20px; }
        
        .btn { background: #f00; color: white; border: none; padding: 15px; margin: 10px 0; width: 100%; border-radius: 10px; cursor: pointer; font-weight: bold; }
        .vip-gold { border-color: gold !important; box-shadow: 0 0 50px gold !important; }
        
        #quiz { display: none; }
        input { width: 80%; padding: 10px; margin: 10px 0; border-radius: 5px; border: none; text-align: center; }
    </style>
</head>
<body>

<div id="ui">
    <div class="card" id="pc-card">
        <h1 id="title">ALUBA ARENA</h1>
        
        <div id="gd-game">
            <p style="font-size: 12px; color: #aaa;">GEOMETRY DASH: Прыгай (Клик/Пробел)</p>
            <canvas id="gdCanvas" width="300" height="150" style="border: 1px solid #333;"></canvas>
            <p id="score">Шипы: 0/10</p>
        </div>

        <div id="quiz">
            <p>ВИКТОРИНА НА VIP:</p>
            <p id="question">1. Какой префикс у мода?</p>
            <input type="text" id="ans" placeholder="Ответ здесь...">
            <button class="btn" onclick="checkQuiz()">ОТВЕТИТЬ</button>
        </div>

        <hr>
        <button id="dl-btn" class="btn" style="background:#333; display:none;" onclick="downloadJar(true)">СКАЧАТЬ VIP JAR</button>
    </div>

    <img id="mobile-chicken" src="https://media1.tenor.com/m/hS9vS4nU6YFpS/chicken-glasses.gif">
    <p id="m-text" style="display:none; color:gold;">ALUBA VIP MOBILE ACTIVE</p>
</div>

<script>
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    const canvas = document.getElementById('gdCanvas');
    const ctx = canvas.getContext('2d');
    
    let gdScore = 0;
    let playerY = 120, velocity = 0, isJumping = false;
    let obstacleX = 300;

    // --- ЛОГИКА ОПРЕДЕЛЕНИЯ УСТРОЙСТВА ---
    if(isMobile) {
        document.getElementById('pc-card').style.display = 'none';
        document.getElementById('mobile-chicken').style.display = 'block';
        document.getElementById('m-text').style.display = 'block';
    } else {
        runGD();
    }

    // --- GEOMETRY DASH ПК ---
    function runGD() {
        if(gdScore >= 10) return;
        requestAnimationFrame(runGD);
        ctx.fillStyle = "#111"; ctx.fillRect(0,0,300,150);
        
        // Игрок (Куб)
        ctx.fillStyle = "#00f2ff";
        ctx.fillRect(50, playerY, 20, 20);
        
        // Гравитация
        if(isJumping) {
            velocity += 0.6; playerY += velocity;
            if(playerY >= 120) { playerY = 120; isJumping = false; }
        }

        // Шип
        ctx.fillStyle = "red";
        ctx.beginPath();
        ctx.moveTo(obstacleX, 140); ctx.lineTo(obstacleX+10, 120); ctx.lineTo(obstacleX+20, 140);
        ctx.fill();
        
        obstacleX -= 4;
        if(obstacleX < -20) { obstacleX = 300; gdScore++; document.getElementById('score').innerText = `Шипы: ${gdScore}/10`; }
        
        // Коллизия
        if(obstacleX < 70 && obstacleX > 30 && playerY > 100) { gdScore = 0; obstacleX = 300; }
        
        if(gdScore >= 10) {
            document.getElementById('gd-game').style.display = 'none';
            document.getElementById('quiz').style.display = 'block';
        }
    }

    window.addEventListener('keydown', (e) => { if(e.code === 'Space' && !isJumping) { velocity = -8; isJumping = true; } });
    canvas.addEventListener('mousedown', () => { if(!isJumping) { velocity = -8; isJumping = true; } });

    // --- ВИКТОРИНА ---
    function checkQuiz() {
        const val = document.getElementById('ans').value.toLowerCase();
        if(val.includes('aluba')) {
            document.getElementById('quiz').innerHTML = "<b style='color:gold;'>ВСЕ ВЕРНО!</b>";
            document.getElementById('pc-card').classList.add('vip-gold');
            document.getElementById('dl-btn').style.display = 'block';
            document.getElementById('title').innerText = "VIP ALUBA UNLOCKED";
        } else {
            alert("НЕВЕРНО! ПОДУМАЙ ЕЩЕ!");
        }
    }

    // --- СБОРКА JAR ---
    async function downloadJar(vip) {
        const zip = new JSZip();
        zip.file("META-INF/mods.toml", `modLoader="javafml"\n[[mods]]\nmodId="alubavip"\ndisplayName="AlubaModVip"`);
        zip.file("pack.mcmeta", `{"pack":{"description":"Aluba VIP","pack_format":6}}`);
        const b64 = "yv66vgAAADQASQoACQAbBwAcBwAdCgAJAB4IAB8KAAkAKAgAKQoAAgAqBwArBwAsCgACAC0IAC4KAAIAMAcAMQcAMgEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJvblJlbmRlckNyb3NzaGFpcgEAKChMbmV0L21pbmVjcmFmdGZvcmdlL2NsaWVudC9ldmVudC9SZW5kZXJHYW1lT3ZlcmxheUV2ZW50JFByZTspVgEADG9uUmVuZGVyTmFtZQEAKChMbmV0L21pbmVjcmFmdGZvcmdlL2NsaWVudC9ldmVudC9SZW5kZXJOYW1lcGxhdGVFdmVudDspVgEAClNvdXJjZUZpbGUBAA5BbHViYU1haW4uamF2YQwACgALBwAzDAA0ADUHADYMADAANQwAOAA5BwA6DAA7ADwBAAhBTFVCQS1QVlAHAAMBAA9jb20vYWx1YmEvcHZwL0FsdWJhTWFpbgEAEGphdmEvbGFuZy9PYmplY3QBABBvcmcvbGp3Z2wvb3BlbmdsL0dMMTEBABJnbEVuYWJsZQEAEmdsSGludAEAEWdsTGluZVNtb290aEhPVA==";
        zip.file("com/aluba/Main.class", Uint8Array.from(atob(b64), c => c.charCodeAt(0)));
        const blob = await zip.generateAsync({type:"blob"});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
        a.download = "AlubaModVip.jar"; a.click();
    }
</script>
</body>
</html>
