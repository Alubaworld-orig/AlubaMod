<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>ALUBA MOD SYSTEM</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        body { margin: 0; background: #050505; color: #fff; font-family: 'Arial Black', sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        
        /* СКРЫТАЯ АДМИНКА */
        #admin-lock { position: fixed; top: 5px; right: 5px; opacity: 0.1; cursor: pointer; color: #fff; font-size: 10px; border: none; background: none; }
        #admin-panel { display: none; position: fixed; top: 40px; right: 10px; width: 280px; background: #111; border: 2px solid #00ff00; padding: 15px; z-index: 1000; border-radius: 10px; box-shadow: 0 0 20px #00ff00; }
        
        .card { background: #000; border: 3px solid #f00; padding: 30px; border-radius: 25px; text-align: center; width: 500px; box-shadow: 0 0 30px #f00; transition: 0.5s; }
        .vip-active { border-color: gold !important; box-shadow: 0 0 80px gold !important; }
        
        #chicken-img { display: none; width: 140px; margin-bottom: 20px; border: 3px solid gold; border-radius: 15px; }

        .btn { background: #f00; color: #fff; border: none; padding: 12px; width: 100%; margin: 5px 0; cursor: pointer; font-weight: bold; border-radius: 10px; text-transform: uppercase; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; background: #1a1a1a; color: gold; border: 1px solid #333; box-sizing: border-box; font-size: 16px; border-radius: 8px; }

        #promo-section { background: rgba(255, 215, 0, 0.1); border: 2px dashed gold; padding: 15px; border-radius: 15px; margin-bottom: 20px; }
        
        #stock-ui, #quiz-ui { display: none; }
        .mod-row { display: flex; justify-content: space-between; align-items: center; background: #0a0a0a; padding: 10px; margin-bottom: 5px; border-radius: 8px; border-left: 4px solid gold; }
    </style>
</head>
<body>

<button id="admin-lock" onclick="authAdmin()">[SYSTEM_A]</button>

<div id="admin-panel">
    <h4 style="color: #00ff00; margin: 0;">ADMIN COMMANDS</h4>
    <input type="text" id="adm-code" placeholder="Код промокода">
    <input type="number" id="adm-val" placeholder="Кол-во модов">
    <button class="btn" style="background:#004400;" onclick="makePromo()">СОЗДАТЬ</button>
    <button class="btn" style="background:#440000; font-size: 9px;" onclick="resetAll()">СБРОСИТЬ ВСЮ ПАМЯТЬ</button>
</div>

<div class="card" id="mainCard">
    <img id="chicken-img" src="https://media.tenor.com/y_v9WqN2MhYAAAAi/chicken-glasses.gif">

    <div id="main-menu">
        <h1 style="color:red; margin:0;">ALUBA ARENA</h1>
        <p style="color:#555">ВЫБЕРИТЕ ДЕЙСТВИЕ</p>
        <button class="btn" style="background: gold; color: black;" onclick="showQuiz()">ПРОЙТИ ТЕСТ НА VIP</button>
        <button class="btn" style="background: #222;" onclick="dl('Aluba_Regular_Mod', true)">СКАЧАТЬ ОБЫЧНЫЙ МОД</button>
    </div>

    <div id="quiz-ui">
        <h3>VERIFICATION</h3>
        <select id="u-group">
            <option value="none">-- КТО ТЫ? --</option>
            <option value="genius">Гениус Евгениус и Генини Алюбабини</option>
            <option value="propanini">Мозгини Пропанини</option>
        </select>
        <input type="text" id="u-ans" placeholder="6 + 7 = SixSeven?">
        <button class="btn" onclick="checkIQ()">ПРОВЕРИТЬ</button>
        <button class="btn" style="background:none; color:#555; font-size:10px;" onclick="showMenu()">НАЗАД</button>
    </div>

    <div id="stock-ui">
        <div id="promo-section">
            <h4 style="color:gold; margin:0 0 10px 0;">АКТИВАЦИЯ VIP ТАЛОНА</h4>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="player-promo" placeholder="ВВЕДИ КОД" style="margin:0;">
                <button class="btn" style="width: 80px; margin:0; background:gold; color:black;" onclick="activate()">ОК</button>
            </div>
        </div>
        <div id="mods-list"></div>
    </div>
</div>

<script>
    // ЗАГРУЗКА ДАННЫХ ИЗ ПАМЯТИ БРАУЗЕРА
    let stock = JSON.parse(localStorage.getItem('alubaStock')) || { 
        "Aluba_Core_VIP": 10, 
        "Aluba_UI_Customizer": 10, 
        "Aluba_Optimization_X": 10 
    };
    let database = JSON.parse(localStorage.getItem('alubaPromos')) || {};

    function save() {
        localStorage.setItem('alubaStock', JSON.stringify(stock));
        localStorage.setItem('alubaPromos', JSON.stringify(database));
    }

    function showQuiz() {
        document.getElementById('main-menu').style.display = 'none';
        document.getElementById('quiz-ui').style.display = 'block';
    }

    function showMenu() {
        document.getElementById('main-menu').style.display = 'block';
        document.getElementById('quiz-ui').style.display = 'none';
    }

    function authAdmin() {
        if(prompt("PASSWORD:") === "12345%%") document.getElementById('admin-panel').style.display = 'block';
    }

    function makePromo() {
        const c = document.getElementById('adm-code').value;
        const v = document.getElementById('adm-val').value;
        if(c && v) {
            database[c] = parseInt(v);
            save();
            alert("Промокод " + c + " создан!");
        }
    }

    function resetAll() {
        localStorage.clear();
        location.reload();
    }

    function checkIQ() {
        const g = document.getElementById('u-group').value;
        const a = document.getElementById('u-ans').value.toLowerCase();
        if(g === 'genius' && (a === 'sixseven' || a === '13')) {
            document.getElementById('quiz-ui').style.display = 'none';
            document.getElementById('chicken-img').style.display = 'inline-block';
            document.getElementById('stock-ui').style.display = 'block';
            document.getElementById('mainCard').classList.add('vip-active');
            draw();
        } else {
            alert("ПРОПАНИНИ ДЕТЕКТЕД!");
            location.reload();
        }
    }

    function draw() {
        const list = document.getElementById('mods-list');
        list.innerHTML = "";
        for (let m in stock) {
            list.innerHTML += `
                <div class="mod-row">
                    <span>${m} (<b>${stock[m]}</b>)</span>
                    <button class="btn" style="width:70px; font-size:10px; background:gold; color:000;" 
                            onclick="dl('${m}', false)" ${stock[m]<=0?'disabled':''}>GET VIP</button>
                </div>`;
        }
    }

    function activate() {
        const code = document.getElementById('player-promo').value;
        if(database[code]) {
            let bonus = database[code];
            for(let m in stock) stock[m] += bonus;
            delete database[code];
            save();
            alert("VIP пополнен на " + bonus);
            draw();
        } else { alert("НЕВЕРНО!"); }
    }

    async function dl(name, isRegular) {
        if(!isRegular) {
            if(stock[name] > 0) stock[name]--;
            save();
            draw();
        }
        const zip = new JSZip();
        zip.file("META-INF/mods.toml", `modLoader="javafml"\n[[mods]]\nmodId="aluba"\ndisplayName="${name}"`);
        zip.file("pack.mcmeta", `{"pack":{"description":"Aluba Mod","pack_format":6}}`);
        const b64 = "yv66vgAAADQASQoACQAbBwAcBwAdCgAJAB4IAB8KAAkAKAgAKQoAAgAqBwArBwAsCgACAC0IAC4KAAIAMAcAMQcAMgEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJvblJlbmRlckNyb3NzaGFpcgEAKChMbmV0L21pbmVjcmFmdGZvcmdlL2NsaWVudC9ldmVudC9SZW5kZXJHYW1lT3ZlcmxheUV2ZW50JFByZTspVgEADG9uUmVuZGVyTmFtZQEAKChMbmV0L21pbmVjcmFmdGZvcmdlL2NsaWVudC9ldmVudC9SZW5kZXJOYW1lcGxhdGVFdmVudDspVgEAClNvdXJjZUZpbGUBAA5BbHViYU1haW4uamF2YQwACgALBwAzDAA0ADUHADYMADAANQwAOAA5BwA6DAA7ADwBAAhBTFVCQS1QVlAHAAMBAA9jb20vYWx1YmEvcHZwL0FsdWJhTWFpbgEAEGphdmEvbGFuZy9PYmplY3QBABBvcmcvbGp3Z2wvb3BlbmdsL0dMMTEBABJnbEVuYWJsZQEAEmdsSGludAEAEWdsTGluZVNtb290aEhPVA==";
        zip.file("com/aluba/Main.class", Uint8Array.from(atob(b64), c => c.charCodeAt(0)));
        const b = await zip.generateAsync({type:"blob"});
        const a = document.createElement('a'); a.href = URL.createObjectURL(b);
        a.download = name + ".jar"; a.click();
    }
</script>
</body>
</html>
